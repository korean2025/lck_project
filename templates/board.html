<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê²Œì‹œíŒ</title>
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable-jp.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Pretendard Variable', 'Noto Sans KR', sans-serif;
      margin: 0;
      padding: 30px;
      background-color: #121212;
      color: #f0f0f0;
      background-image: radial-gradient(#1a1a1a 1px, transparent 1px);
      background-size: 20px 20px;
      animation: fadeIn 0.6s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    nav {
      display: flex;
      justify-content: center;
      gap: 40px;
      background-color: #1e1e1e;
      padding: 20px 0;
      border-radius: 10px;
      margin-bottom: 40px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }

    nav a {
      color: #f1c40f;
      text-decoration: none;
      font-size: 16px;
      font-weight: bold;
      transition: color 0.3s;
    }

    nav a:hover {
      color: #ffffff;
      text-shadow: 0 0 10px #f1c40f;
    }

    .container {
      max-width: 850px;
      margin: auto;
      background-color: #1e1e1e;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(255, 255, 0, 0.1);
    }

    h1 {
      text-align: center;
      color: #ffeb3b;
      margin-bottom: 30px;
      font-size: 2rem;
    }

    .new-post-btn {
      display: inline-block;
      padding: 12px 20px;
      background-color: #ffeb3b;
      color: #000;
      font-weight: bold;
      text-decoration: none;
      border-radius: 8px;
      transition: background-color 0.3s, transform 0.2s;
    }
    
    .new-post-wrapper {
  display: flex;
  justify-content: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
  margin-bottom: 20px;
}

    .new-post-btn:hover {
      background-color: #fdd835;
      transform: translateY(-2px);
    }

    .post-list {
      list-style: none;
      padding: 0;
    }

    .post-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #333;
      padding: 15px 0;
      transition: background-color 0.3s;
    }

    .post-item:hover {
      background-color: #2a2a2a;
    }

    .post-title a {
      text-decoration: none;
      color: #f0f0f0;
      font-weight: 600;
      font-size: 1.1em;
      transition: color 0.3s;
    }

    .post-title a:hover {
      color: #ffeb3b;
    }

    .post-meta {
      font-size: 0.85em;
      color: #bbb;
      text-align: right;
      min-width: 160px;
    }

    .no-post {
      text-align: center;
      margin-top: 40px;
      font-size: 1em;
      color: #aaa;
    }
/* ì±„íŒ…ì°½ ìŠ¤íƒ€ì¼ */
#chat-container {
  position: fixed;
  right: 0;
  top: 0;
  width: 320px;
  height: 100%;
  background: linear-gradient(to bottom, #1e1e1e, #121212);
  border-left: 1px solid rgba(255, 235, 59, 0.1);
  box-shadow: -4px 0 20px rgba(255, 235, 59, 0.15);
  display: flex;
  flex-direction: column;
  padding: 15px;
  box-sizing: border-box;
  z-index: 1000;
  animation: slideInRight 0.7s ease-out;
}

@keyframes slideInRight {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

#chat-container h2 {
  color: #f1c40f;
  text-align: center;
  margin-bottom: 15px;
  font-size: 20px;
  text-shadow: 0 0 8px rgba(255, 235, 59, 0.4);
}

#chatArea {
  flex-grow: 1;
  border: 1px solid #444;
  padding: 10px;
  overflow-y: auto;
  background-color: #1c1c1c;
  margin-bottom: 10px;
  color: #ddd;
  font-size: 14px;
  border-radius: 6px;
  box-shadow: inset 0 0 5px rgba(255, 235, 59, 0.05);
}

#chatArea p {
  margin: 6px 0;
}

#chatArea p strong {
  color: #f1c40f;
}

#usernameInput,
#messageInput {
  padding: 10px;
  border: 1px solid #444;
  background-color: #1c1c1c;
  color: white;
  border-radius: 5px;
  font-size: 14px;
  transition: all 0.2s ease-in-out;
}

#usernameInput {
  width: 60px;
  padding: 6px 8px;
  font-size: 12px;
  margin-right: 4px;
}

#messageInput {
  width: calc(100% - 130px); /* username + ë²„íŠ¼ ê³µê°„ ê³ ë ¤ */
  padding: 8px 10px;
  font-size: 13px;
}

#usernameInput:focus,
#messageInput:focus {
  border-color: #f1c40f;
  outline: none;
  box-shadow: 0 0 8px rgba(255, 235, 59, 0.2);
}

#sendButton {
  width: 60px;
  padding: 8px 0;
  font-size: 13px;
  background: linear-gradient(135deg, #f1c40f, #ffeb3b);
  color: black;
  border: none;
  cursor: pointer;
  margin-left: 10px;
  border-radius: 5px;
  font-weight: bold;
  transition: all 0.3s ease;
  box-shadow: 0 0 8px rgba(255, 235, 59, 0.4);
}

#sendButton:hover {
  background: linear-gradient(135deg, #fff176, #fbc02d);
  transform: translateY(-1px);
  box-shadow: 0 0 12px rgba(255, 235, 59, 0.6);
}
.me-message {
  background-color: #f1c40f;
  color: #000;
  align-self: flex-end;
  max-width: 70%;
  padding: 10px 14px;
  border-radius: 18px 18px 4px 18px;
  margin: 6px 0;
  position: relative;
  word-break: break-word;
}

.me-message::after {
  content: "";
  position: absolute;
  right: -8px;
  top: 12px;
  width: 0;
  height: 0;
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  border-left: 8px solid #f1c40f;
}

.other-message {
  background-color: #2c2c2c;
  color: #f0f0f0;
  align-self: flex-start;
  max-width: 70%;
  padding: 10px 14px;
  border-radius: 18px 18px 18px 4px;
  margin: 6px 0;
  position: relative;
  word-break: break-word;
}

.other-message::after {
  content: "";
  position: absolute;
  left: -8px;
  top: 12px;
  width: 0;
  height: 0;
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  border-right: 8px solid #2c2c2c;
}

    .side-nav {
  position: fixed;
  
  left: 20px;
  transform: translateY(15%);
  width: 70px;
  padding: 15px 10px;
  background: rgba(0, 0, 0, 0.6); /* ì–´ë‘ìš´ ë°˜íˆ¬ëª… ë°°ê²½ */
  border: 1px solid rgba(241, 196, 15, 0.2); /* ë…¸ë€ í…Œë‘ë¦¬ */
  border-radius: 30px;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  box-shadow: 0 0 15px rgba(241, 196, 15, 0.1); /* ì€ì€í•œ ë„¤ì˜¨ glow */
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
  z-index: 1000;
}


.side-nav a {
  position: relative;
  display: block;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  overflow: visible;
  transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
}

.side-nav a:hover {
  transform: scale(1.1);
  box-shadow: 0 0 15px rgba(241, 196, 15, 0.7);
}

.side-nav img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
  display: block;
}

/* íˆ´íŒ (ì˜¤ë¥¸ìª½ ìœ„ì¹˜) */
.tooltip {
  position: absolute;
  left: 60px;
  top: 50%;
  transform: translateY(-50%) scale(0.8);
  background: linear-gradient(135deg, #2c2c2c, #1a1a1a);
  color: #ffeb3b;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  box-shadow: 0 0 0 transparent;
  transition:
    opacity 0.4s ease,
    transform 0.4s ease,
    box-shadow 0.4s ease;
  z-index: 999;
}

/* ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
.side-nav a:hover .tooltip {
  opacity: 1;
  transform: translateY(-50%) translateX(8px) scale(1);
  box-shadow: 0 0 10px rgba(255, 235, 59, 0.6),
              0 0 20px rgba(255, 235, 59, 0.2);
}
.notice-item, .board-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #333;
  padding: 15px 20px;
  border-radius: 8px;
  margin-bottom: 10px;
  transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
  background-color: #1f1f1f;
  backdrop-filter: blur(2px);
}

.notice-item:hover, .board-item:hover {
  background-color: #2b2b2b;
  box-shadow: 0 4px 16px rgba(255, 235, 59, 0.1);
  transform: translateY(-2px);
}

.post-title span::before {
  content: \"\\1F4E2\"; /* ğŸ“¢ */
  margin-right: 8px;
  color: #ffeb3b;
}

.post-meta div {
  transition: color 0.2s;
}

.notice-item:hover .post-meta div,
.board-item:hover .post-meta div {
  color: #f1c40f;
}

.no-post {
  text-align: center;
  margin-top: 40px;
  font-size: 1.1em;
  color: #888;
  opacity: 0;
  animation: fadeInEmpty 0.8s ease-in-out 0.2s forwards;
}

@keyframes fadeInEmpty {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ë” ë§ì€ í•­ëª©ì„ ìœ„í•œ ì• ë‹ˆë©”ì´ì…˜ ë”œë ˆì´ í™•ì¥ */
.notice-item:nth-child(6) { animation-delay: 0.25s; }
.notice-item:nth-child(7) { animation-delay: 0.3s; }
.notice-item:nth-child(8) { animation-delay: 0.35s; }
.notice-item:nth-child(9) { animation-delay: 0.4s; }
.notice-item:nth-child(10) { animation-delay: 0.45s; }

  </style>
</head>
<body>
  <nav>
    <a href="/">í™ˆ</a>
    <a href="/player_comparison">ì„ ìˆ˜ë¹„êµ</a>
    <a href="/Simulator">ì‹œë®¬ë ˆì´í„°</a>
    <a href="/board">ê²Œì‹œíŒ</a>
    <a href="https://esports.op.gg/?hl=ko_KR" target="_blank">Esports.op.gg</a>
    <a href="https://www.fow.lol/" target="_blank">FOW.KR</a>
  </nav>
  <div class="side-nav">
  <a href="/bnk_fearx" >
    <img src="static/images/BNK FEARX.png" alt="BNK FEARX" />
  <span class="tooltip">BNK FEARX</span></a>

  <a href="/dn_freecs" >
    <img src="static/images/DN freecs.png" alt="DN freecs" />
  <span class="tooltip">DN freecs</span></a>

  <a href="/dplus_kia" >
    <img src="static/images/Dplus KIA.png" alt="Dplus KIA" />
  <span class="tooltip">Dplus KIA</span></a>

  <a href="/hanwha_life_esports" >
    <img src="static/images/Hanwha Life Esports.png" alt="Hanwha Life Esports" />
  <span class="tooltip">Hanwha Life Esports</span></a>

  <a href="/gen_g" >
    <img src="static/images/Gen.G.png" alt="Gen.G" />
  <span class="tooltip">Gen.G</span></a>

  <a href="/drx" >
    <img src="static/images/DRX.png" alt="DRX" />
  <span class="tooltip">DRX</span></a>

  <a href="/kt_rolster" >
    <img src="static/images/kt rolster.png" alt="kt rolster" />
  <span class="tooltip">KT Rolster</span></a>

  <a href="/oksavingsbank_brion" >
    <img src="static/images/OKSavingsBank BRION.png" alt="BRION" />
  <span class="tooltip">BRION</span></a>

  <a href="/nongshim_redforce" >
    <img src="static/images/Nongshim RedForce.png" alt="Nongshim RedForce" />
  <span class="tooltip">Nongshim RedForce</span></a>

  <a href="/T1" >
    <img src="static/images/T1.png" alt="T1" />
  <span class="tooltip">T1</span></a>
</div>
<div id="noticeModal" style="display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7); align-items: center; justify-content: center;">
    <div style="background-color: #1e1e1e; margin: auto; padding: 30px; border-radius: 12px; max-width: 600px; box-shadow: 0 8px 20px rgba(255, 235, 59, 0.2); position: relative; color: #f0f0f0;">
        <span class="close-button" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
        <h2 id="modalTitle" style="color: #ffeb3b; margin-bottom: 20px; text-align: center;"></h2>
        <div id="modalContent" style="margin-bottom: 20px; line-height: 1.6;"></div>
        <p style="font-size: 0.9em; color: #bbb;">ì‘ì„±ì: <span id="modalAuthor"></span></p>
        <p style="font-size: 0.9em; color: #bbb;">ì‘ì„±ì¼: <span id="modalDate"></span></p>
    </div>
</div>


 <div class="container">

  <h1>ê³µì§€ì‚¬í•­</h1>
  <ul class="post-list">
Â  Â  Â  {% for notice in notices %} {# 'posts' ëŒ€ì‹  'notices' ì‚¬ìš© #}
Â  Â  Â  <li class="post-item" onclick="openNoticeModal('{{ notice.title | escape }}', '{{ notice.content | escape }}', 'ê´€ë¦¬ì', '{{ notice.date_posted.strftime('%Y-%m-%d %H:%M') }}')">
Â  Â  Â  Â  <div class="post-title">
Â  Â  Â  Â  Â  <a>{{ notice.title }}</a> {# href ì œê±°, í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ë¦¼ #}
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="post-meta">
Â  Â  Â  Â  Â  <div>ì‘ì„±ì: ê´€ë¦¬ì</div> {# ê³µì§€ì‚¬í•­ ì‘ì„±ì ê³ ì • #}
Â  Â  Â  Â  Â  <div>{{ notice.date_posted.strftime('%Y-%m-%d %H:%M') }}</div>
Â  Â  Â  Â  </div>
Â  Â  Â  </li>
Â  Â  Â  {% else %}
Â  Â  Â  <p class="no-post">ì•„ì§ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
Â  Â  Â  {% endfor %}
Â  Â  </ul>
Â  </div>

  <div class="container">
    
    <h1>ê²Œì‹œíŒ</h1>
    <ul class="post-list">
      {% for post in posts %}
      <li class="post-item">
        <div class="post-title">
          <a href="{{ url_for('post_detail', post_id=post.id) }}">{{ post.title }}</a>
        </div>
        <div class="post-meta">
          <div>ì‘ì„±ì: {{ post.author or 'ìµëª…' }}</div>
          <div>{{ post.date_posted.strftime('%Y-%m-%d %H:%M') }}</div>
        </div>
      </li>
      {% else %}
      <p class="no-post">ì•„ì§ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
      {% endfor %}
    </ul>
    <div class="new-post-wrapper">
      <a href="{{ url_for('new_post') }}" class="new-post-btn">ìƒˆ ê¸€ ì‘ì„±</a>
    </div>  
  </div>


<div id="chat-container">
    <h2>ì‹¤ì‹œê°„ ì±„íŒ…</h2>
    <div id="chatArea"></div>
    <div style="display: flex; margin-top: auto;">
        <input type="text" id="usernameInput" placeholder="ì´ë¦„" style="width: 80px; margin-right: 5px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
        <input type="text" id="messageInput" placeholder="ì—¬ê¸°ì— ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
        <button id="sendButton">ë³´ë‚´ê¸°</button>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>

<script type="text/javascript">
    // 1. í•„ìš”í•œ ê²ƒë“¤ì„ ì»´í“¨í„°ì—ê²Œ ì•Œë ¤ì¤˜ìš”.
    const chatArea = document.getElementById('chatArea');          // ì±„íŒ… ë‚´ìš©ì´ ë³´ì´ëŠ” ê³³
    const usernameInput = document.getElementById('usernameInput'); // ì‚¬ìš©ì ì´ë¦„ ì…ë ¥í•˜ëŠ” ê³³
    const messageInput = document.getElementById('messageInput'); // ë©”ì‹œì§€ ì…ë ¥í•˜ëŠ” ê³³
    const sendButton = document.getElementById('sendButton');     // ë³´ë‚´ê¸° ë²„íŠ¼

    // --- ì¶”ê°€ëœ ë¶€ë¶„: ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ê´€ë ¨ í•¨ìˆ˜ ---
    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì´ë¦„ ì €ì¥
    function saveUsername(username) {
        localStorage.setItem('chatUsername', username);
    }

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì´ë¦„ ë¶ˆëŸ¬ì˜¤ê¸°
    function loadUsername() {
        return localStorage.getItem('chatUsername');
    }

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì±„íŒ… ë©”ì‹œì§€ ì €ì¥
    function saveChatMessages(messages) {
        try {
            localStorage.setItem('chatHistory', JSON.stringify(messages));
            // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥ (ì„ íƒ ì‚¬í•­)
            localStorage.setItem('chatScrollTop', chatArea.scrollTop);
        } catch (e) {
            console.error("ì±„íŒ… ê¸°ë¡ ì €ì¥ ì‹¤íŒ¨:", e);
        }
    }

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì±„íŒ… ë©”ì‹œì§€ ë¶ˆëŸ¬ì˜¤ê¸°
    function loadChatMessages() {
        try {
            const history = localStorage.getItem('chatHistory');
            return history ? JSON.parse(history) : [];
        } catch (e) {
            console.error("ì±„íŒ… ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", e);
            return [];
        }
    }

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ë¶ˆëŸ¬ì˜¤ê¸°
    function loadChatScrollTop() {
        const scrollTop = localStorage.getItem('chatScrollTop');
        return scrollTop ? parseInt(scrollTop, 10) : null;
    }
    // --- ì¶”ê°€ëœ ë¶€ë¶„ ë ---

    // 2. ì„œë²„ì— ì—°ê²°í•  Socket.IOë¥¼ ë§Œë“¤ì–´ìš”.
    // í˜„ì¬ í˜ì´ì§€ì˜ ë„ë©”ì¸ê³¼ í¬íŠ¸ë¡œ ìë™ ì—°ê²°ë©ë‹ˆë‹¤.
    const socket = io.connect('http://' + document.domain + ':' + location.port);

    // --- ì¶”ê°€ëœ ë¶€ë¶„: í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” ---
    window.onload = function() {
        // 1. ì €ì¥ëœ ì‚¬ìš©ì ì´ë¦„ ë¶ˆëŸ¬ì™€ì„œ inputì— ì±„ìš°ê¸°
        const savedName = loadUsername();
        if (savedName) {
            usernameInput.value = savedName;
        } else {
            // ì²˜ìŒ ë°©ë¬¸ ì‹œ ë˜ëŠ” ì €ì¥ëœ ì´ë¦„ì´ ì—†ì„ ì‹œ 'ìµëª…'ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ
            usernameInput.value = 'ìµëª…';
        }

        // 2. ì €ì¥ëœ ì±„íŒ… ë©”ì‹œì§€ ë¶ˆëŸ¬ì™€ì„œ chatAreaì— í‘œì‹œ
        const savedMessages = loadChatMessages();
        savedMessages.forEach(msg => {
            // ë©”ì‹œì§€ ê°ì²´ëŠ” { username: 'ì´ë¦„', message: 'ë‚´ìš©' } í˜•íƒœì—¬ì•¼ í•¨
            const p = document.createElement('p');
            if (msg.username === usernameInput.value.trim()) {
                p.classList.add('me-message');
            } else {
                p.classList.add('other-message');
            }
            p.textContent = (msg.username ? msg.username + ': ' : '') + msg.message;
            chatArea.appendChild(p);
        });

        // 3. ì €ì¥ëœ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¡œ ì´ë™ (ì—†ìœ¼ë©´ ê°€ì¥ ì•„ë˜ë¡œ)
        const savedScrollTop = loadChatScrollTop();
        if (savedScrollTop !== null) {
            chatArea.scrollTop = savedScrollTop;
        } else {
            chatArea.scrollTop = chatArea.scrollHeight;
        }
    };
    // --- ì¶”ê°€ëœ ë¶€ë¶„ ë ---


    // 3. ì„œë²„ì™€ ì—°ê²°ì´ ì˜ ë˜ì—ˆì„ ë•Œ (Socket.IO 'connect' ì´ë²¤íŠ¸)
    socket.on('connect', function() {
        console.log('ì„œë²„ë‘ ì—°ê²°ë˜ì—ˆì–´ìš”! ì´ì œ ì±„íŒ…í•  ìˆ˜ ìˆì–´ìš”.');
        // 'status' ì´ë²¤íŠ¸ëŠ” ì„œë²„ì—ì„œ ë³´ë‚¼ ë•Œë§Œ ë°›ìŠµë‹ˆë‹¤.
        // chatArea.innerHTML += '<p class="status-message"><strong>[ì•Œë¦¼] ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.</strong></p>';
    });

    // 4. ì„œë²„ë¡œë¶€í„° ë©”ì‹œì§€ê°€ ë„ì°©í–ˆì„ ë•Œ (Socket.IO 'message' ì´ë²¤íŠ¸)
    socket.on('message', function(data) {
        const p = document.createElement('p');

        // ì‚¬ìš©ì ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
        const myName = usernameInput.value.trim();

        // ë‚´ ë©”ì‹œì§€ì¸ì§€ í™•ì¸í•´ì„œ ìŠ¤íƒ€ì¼ ë‹¤ë¥´ê²Œ ì ìš©
        if (data.username === myName) {
            p.classList.add('me-message');
        } else {
            p.classList.add('other-message');
        }

        // ë©”ì‹œì§€ ë‚´ìš© ì„¤ì •
        p.textContent = (data.username ? data.username + ': ' : '') + data.message;
        chatArea.appendChild(p);
        chatArea.scrollTop = chatArea.scrollHeight;

        // --- ì¶”ê°€ëœ ë¶€ë¶„: ë°›ì€ ë©”ì‹œì§€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ ---
        let currentMessages = loadChatMessages();
        currentMessages.push({ username: data.username, message: data.message });
        saveChatMessages(currentMessages);
        // --- ì¶”ê°€ëœ ë¶€ë¶„ ë ---
    });


    // 5. ì„œë²„ë¡œë¶€í„° ìƒíƒœ ë©”ì‹œì§€ê°€ ë„ì°©í–ˆì„ ë•Œ (Socket.IO 'status' ì´ë²¤íŠ¸)
    socket.on('status', function(data) {
        const p = document.createElement('p');
        p.classList.add('status-message');
        p.textContent = data.msg;
        chatArea.appendChild(p);
        chatArea.scrollTop = chatArea.scrollHeight;
    });

    // 6. ì„œë²„ì™€ ì—°ê²°ì´ ëŠê²¼ì„ ë•Œ (Socket.IO 'disconnect' ì´ë²¤íŠ¸)
    socket.on('disconnect', function() {
        console.log('ì„œë²„ë‘ ì—°ê²°ì´ ëŠê²¼ì–´ìš”.');
        const p = document.createElement('p');
        p.classList.add('status-message');
        p.textContent = '[ì•Œë¦¼] ì„œë²„ì™€ ì—°ê²°ì´ ëŠê²¼ìŠµë‹ˆë‹¤.';
        chatArea.appendChild(p);
        chatArea.scrollTop = chatArea.scrollHeight;
        // --- ì¶”ê°€ëœ ë¶€ë¶„: ì—°ê²°ì´ ëŠê²¼ì„ ë•Œ ì¬ì—°ê²° ì‹œë„ ---
        console.log("3ì´ˆ í›„ Socket.IO ì¬ì—°ê²° ì‹œë„...");
        setTimeout(() => {
            // io.connectë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ë©´ Socket.IOê°€ ì¬ì—°ê²°ì„ ì‹œë„í•©ë‹ˆë‹¤.
            // ì´ë¯¸ socket ê°ì²´ê°€ ìˆìœ¼ë¯€ë¡œ socket.connect()ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
            socket.connect();
        }, 3000);
        // --- ì¶”ê°€ëœ ë¶€ë¶„ ë ---
    });

    // 7. ë¬¸ì œê°€ ìƒê²¼ì„ ë•Œ (Socket.IO 'error' ì´ë²¤íŠ¸ - ì˜ ë°œìƒí•˜ì§„ ì•ŠìŒ)
    socket.on('error', function(err) {
        console.error('ì›¹ì†Œì¼“ ì˜¤ë¥˜ ë°œìƒ:', err);
        const p = document.createElement('p');
        p.classList.add('status-message');
        p.textContent = '[ì˜¤ë¥˜] ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!';
        chatArea.appendChild(p);
        chatArea.scrollTop = chatArea.scrollHeight;
    });

    // 8. ë©”ì‹œì§€ ë³´ë‚´ê¸° ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ
    sendButton.onclick = function() {
        sendMessage();
    };

    // 9. ë©”ì‹œì§€ ì…ë ¥ ì¹¸ì—ì„œ ì—”í„° í‚¤ë¥¼ ëˆŒë €ì„ ë•Œ
    messageInput.onkeypress = function(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    };

    // 10. ë©”ì‹œì§€ë¥¼ ì‹¤ì œë¡œ ë³´ë‚´ëŠ” í•¨ìˆ˜
    function sendMessage() {
        const username = usernameInput.value.trim(); // ì‚¬ìš©ì ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
        const message = messageInput.value.trim();  // ì…ë ¥ ì¹¸ì— ìˆëŠ” ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì™€ìš”.

        if (username === '') {
            alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }

        if (message !== '') { // ë©”ì‹œì§€ê°€ ë¹„ì–´ìˆì§€ ì•Šë‹¤ë©´
            // Socket.IOëŠ” emitì„ ì‚¬ìš©í•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
            // ì„œë²„ì˜ 'message' í•¸ë“¤ëŸ¬ë¡œ 'message' ì´ë²¤íŠ¸ì™€ í•¨ê»˜ ë°ì´í„°ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
            socket.emit('message', { username: username, message: message });
            messageInput.value = ''; // ë©”ì‹œì§€ë¥¼ ë³´ë‚¸ í›„ ì…ë ¥ ì¹¸ì„ ë¹„ì›Œìš”.

            // --- ì¶”ê°€ëœ ë¶€ë¶„: ë³´ë‚¸ ë©”ì‹œì§€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ ---
            // ì„œë²„ë¡œë¶€í„° ë©”ì‹œì§€ë¥¼ ë‹¤ì‹œ ë°›ì•„ í™”ë©´ì— ê·¸ë¦¬ëŠ” ë°©ì‹ì´ë¼ë©´ ì´ ë¶€ë¶„ì€ ìƒëµ ê°€ëŠ¥
            // í•˜ì§€ë§Œ ì¦‰ê°ì ì¸ ì‚¬ìš©ì í”¼ë“œë°±ì„ ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¨¼ì € ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì 
            let currentMessages = loadChatMessages();
            currentMessages.push({ username: username, message: message });
            saveChatMessages(currentMessages);
            // --- ì¶”ê°€ëœ ë¶€ë¶„ ë ---

            // --- ì¶”ê°€ëœ ë¶€ë¶„: ì´ë¦„ë„ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ ---
            saveUsername(username);
            // --- ì¶”ê°€ëœ ë¶€ë¶„ ë ---
        }
    }

    // ëª¨ë‹¬ ê´€ë ¨ DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
Â  Â  Â  const noticeModal = document.getElementById('noticeModal');
Â  Â  Â  const closeButton = noticeModal.querySelector('.close-button');
Â  Â  Â  const modalTitle = document.getElementById('modalTitle');
Â  Â  Â  const modalContent = document.getElementById('modalContent');
Â  Â  Â  const modalAuthor = document.getElementById('modalAuthor');
Â  Â  Â  const modalDate = document.getElementById('modalDate');

Â  Â  Â  // ëª¨ë‹¬ ì—´ê¸° í•¨ìˆ˜ (ì´ë¦„ì„ openNoticeModalë¡œ ë³€ê²½)
Â  Â  Â  function openNoticeModal(title, content, author, date) {
Â  Â  Â  Â  Â  modalTitle.textContent = title;
Â  Â  Â  Â  Â  modalContent.innerHTML = content.replace(/\n/g, '<br>'); // ì¤„ë°”ê¿ˆ ë¬¸ì <br> íƒœê·¸ë¡œ ë³€í™˜
Â  Â  Â  Â  Â  modalAuthor.textContent = author;
Â  Â  Â  Â  Â  modalDate.textContent = date;
Â  Â  Â  Â  Â  noticeModal.style.display = 'flex'; // flexë¡œ ë³€ê²½í•˜ì—¬ ì¤‘ì•™ ì •ë ¬ í™œì„±í™”
Â  Â  Â  }

Â  Â  Â  // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
Â  Â  Â  function closeModal() {
Â  Â  Â  Â  Â  noticeModal.style.display = 'none'; // ëª¨ë‹¬ ìˆ¨ê¹€
Â  Â  Â  }

Â  Â  Â  // ë‹«ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
Â  Â  Â  closeButton.onclick = function() {
Â  Â  Â  Â  Â  closeModal();
Â  Â  Â  }

Â  Â  Â  // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
Â  Â  Â  window.onclick = function(event) {
Â  Â  Â  Â  Â  if (event.target == noticeModal) {
Â  Â  Â  Â  Â  Â  Â  closeModal();
Â  Â  Â  Â  Â  }
}
</script>
</body>
</html>
